<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="рдкрд░рд┐рд╡рд╛рд░ рд╡реГрдХреНрд╖">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icon-192.png">
  <style>
    /* LOADING SCREEN STYLES */
    #loadingScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    #loadingScreen.fade-out {
      opacity: 0;
      visibility: hidden;
    }
    .loading-logo {
      width: 100px;
      height: 100px;
      border-radius: 20px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      margin-bottom: 20px;
      animation: pulse 1.5s infinite ease-in-out;
    }
    .loading-spinner {
      width: 32px;
      height: 32px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid black;
      border-radius: 50%;
      animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  </style>
  <title>рдкрд╛рдВрдбреЗ рдкрд░рд┐рд╡рд╛рд░ рд╡реГрдХреНрд╖</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- LOADING SCREEN -->
  <div id="loadingScreen">
    <img src="assets/icon-192.png" alt="Logo" class="loading-logo">
    <div class="loading-spinner"></div>
  </div>

  <!-- HOME PAGE -->
    <div id="homePage">
        <h1>рдкрд╛рдВрдбреЗ рдкрд░рд┐рд╡рд╛рд░ рд╡реГрдХреНрд╖</h1>
        <p class="subtitle">рдЧрд╛рдБрд╡ рдХреЗ рд╕рднреА рдкрд░рд┐рд╡рд╛рд░реЛрдВ рдХрд╛ рд╕рдВрдкреВрд░реНрдг рд╡реГрдХреНрд╖</p>
        <p class="stats" id="familyStats">рдХреБрд▓: 0 рд╕рджрд╕реНрдп | 0 рдкреАрдврд╝рд┐рдпрд╛рдБ</p>
        
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="рдирд╛рдо рдЦреЛрдЬреЗрдВ...">
                <button class="clear-search" id="clearSearch">тЬХ</button>
            </div>

            <div class="search-filters">
                <button class="filter-btn active" data-filter="all">рд╕рднреА</button>
                <button class="filter-btn" data-filter="name">рдирд╛рдо рд╕реЗ</button>
                <button class="filter-btn" data-filter="father">рдкрд┐рддрд╛ рд╕реЗ</button>
                <button class="filter-btn" data-filter="year">рд╡рд░реНрд╖ рд╕реЗ</button>
            </div>

            <div id="searchResults"></div>
        </div>

        <div class="btn-group">
            <button class="btn" onclick="showFullTree()">рдкреВрд░рд╛ рд╡реГрдХреНрд╖ рджреЗрдЦреЗрдВ</button>
            <button class="btn btn-secondary" onclick="showGenerationView()">рдкреАрдврд╝реА рдЕрдиреБрд╕рд╛рд░ рджреЗрдЦреЗрдВ</button>
            <button class="btn btn-secondary" onclick="showCalculator()">рд╕рдВрдмрдВрдз рдХреИрд▓рдХреБрд▓реЗрдЯрд░</button>
            <button class="btn btn-secondary" onclick="showLineage()">рдореЗрд░рд╛ рд╡рдВрд╢ рджреЗрдЦреЗрдВ</button>
            <button class="btn btn-secondary" onclick="showVillagePage()"> рд╣рдорд╛рд░рд╛ рдЧрд╛рдБрд╡</button>
            <!-- <button class="btn btn-primary" onclick="showAddMember()">+ рдирдпрд╛ рд╕рджрд╕реНрдп рдЬреЛрдбрд╝реЗрдВ</button> -->
        </div>
    </div>

    <!-- TREE PAGE -->
    <div id="treePage">
        <div class="header">
            <button class="back-btn" onclick="goHome()">тЖР рд╡рд╛рдкрд╕</button>
            <div class="header-title" id="treeTitle">рдкрд░рд┐рд╡рд╛рд░ рд╡реГрдХреНрд╖</div>
            <button class="help-btn" onclick="showHelp()">?</button>
        </div>

        <div class="mobile-controls">
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomOut()">тИТ</button>
                <span class="zoom-level" id="zoomLevel">100%</span>
                <button class="zoom-btn" onclick="zoomIn()">+</button>
            </div>
            

            
            <div class="info-text">тЖФ рд╕реНрд╡рд╛рдЗрдк рдХрд░реЗрдВ | рджреЛ рдЙрдВрдЧрд▓реА рд╕реЗ рдЬрд╝реВрдо рдХрд░реЗрдВ</div>
        </div>

        <div class="generation-nav" id="generationNav" style="display: none;"></div>

        <div id="treeContainer">
            <div class="tree-wrapper" id="treeWrapper">
                <div class="loading">рд╡реГрдХреНрд╖ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div>
            </div>
        </div>

        <div id="personDetails"></div>

        <div class="quick-actions" id="quickActions">
            <!-- Smart View button is added dynamically by JS -->
        </div>
    </div>

    <!-- HELP MODAL -->
    <div class="modal" id="helpModal">
        <div class="modal-content">
            <div class="modal-title">рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</div>
            
            <div class="help-item">
                <div class="help-item-title">ЁЯФН рдЦреЛрдЬреЗрдВ</div>
                <div class="help-item-desc">рдирд╛рдо, рдкрд┐рддрд╛ рдХрд╛ рдирд╛рдо, рдпрд╛ рдЬрдиреНрдо рд╡рд░реНрд╖ рд▓рд┐рдЦреЗрдВред рдлрд╝рд┐рд▓реНрдЯрд░ рдмрдЯрди рд╕реЗ рдЦреЛрдЬ рдХреЛ рд╕реАрдорд┐рдд рдХрд░реЗрдВред</div>
            </div>

            <div class="help-item">
                <div class="help-item-title">ЁЯСЖ рдиреЛрдб рджрдмрд╛рдПрдВ</div>
                <div class="help-item-desc">рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдиреЛрдб рдХреЛ рджрдмрд╛рдХрд░ рдЙрдирдХреА рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВред</div>
            </div>

            <div class="help-item">
                <div class="help-item-title">ЁЯФО рдЬрд╝реВрдо рдХрд░реЗрдВ</div>
                <div class="help-item-desc">+ рдФрд░ тИТ рдмрдЯрди рд╕реЗ рдпрд╛ рджреЛ рдЙрдВрдЧрд▓рд┐рдпреЛрдВ рд╕реЗ рдЬрд╝реВрдо рдЗрди/рдЖрдЙрдЯ рдХрд░реЗрдВред</div>
            </div>

            <div class="help-item">
                <div class="help-item-title">ЁЯУ▒ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдореЛрдб</div>
                <div class="help-item-desc">рдмрдбрд╝реЗ рдкрд░рд┐рд╡рд╛рд░ рдХреЛ рдПрдХ рд╕реНрдХреНрд░реАрди рдкрд░ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП "рд╕рдВрдХреНрд╖рд┐рдкреНрдд" рдмрдЯрди рджрдмрд╛рдПрдВред</div>
            </div>

            <div class="help-item">
                <div class="help-item-title">тЖФя╕П рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ</div>
                <div class="help-item-desc">рдЙрдВрдЧрд▓реА рд╕реЗ рд╕реНрд╡рд╛рдЗрдк рдХрд░рдХреЗ рд╡реГрдХреНрд╖ рдХреЛ рд╕рднреА рджрд┐рд╢рд╛рдУрдВ рдореЗрдВ рджреЗрдЦреЗрдВред</div>
            </div>

            <button class="close-modal" onclick="closeHelp()">рдмрдВрдж рдХрд░реЗрдВ</button>
        </div>
    </div>

    <!-- ADD MEMBER MODAL -->
    <div class="modal" id="addMemberModal">
        <div class="modal-content">
            <div class="modal-title">рдирдпрд╛ рд╕рджрд╕реНрдп рдЬреЛрдбрд╝реЗрдВ (Instant Add)</div>
            <div class="calc-form">
                <div class="calc-input-group">
                    <label>рдорд╛рддрд╛/рдкрд┐рддрд╛ (Parent)</label>
                    <div class="autocomplete">
                        <input type="text" id="addParentInput" placeholder="рдкрд┐рддрд╛/рдорд╛рддрд╛ рдХрд╛ рдирд╛рдо рдЦреЛрдЬреЗрдВ..." autocomplete="off">
                        <div id="addParentList" class="autocomplete-items"></div>
                    </div>
                </div>
                <div class="calc-input-group">
                    <label>рдирд╛рдо (рд╣рд┐рдВрджреА)</label>
                    <div class="autocomplete">
                        <input type="text" id="addNameHi" placeholder="рдЙрджрд╛: рдЧрд░рд┐рдорд╛ рдкрд╛рдВрдбреЗрдп" autocomplete="off">
                        <div id="addNameHiList" class="autocomplete-items"></div>
                    </div>
                </div>
                <div class="calc-input-group">
                    <label>Name (English)</label>
                    <div class="autocomplete">
                        <input type="text" id="addNameEn" placeholder="e.g. Garima Pandey" autocomplete="off">
                        <div id="addNameEnList" class="autocomplete-items"></div>
                    </div>
                </div>
                <div class="calc-input-group">
                    <label>рдЬрдиреНрдо рд╡рд░реНрд╖ (Birth Year)</label>
                    <input type="number" id="addBirthYear" placeholder="2005">
                </div>
                
                <button class="btn calc-btn" onclick="addMemberToTree()">рдЬреЛрдбрд╝реЗрдВ (Add to Tree)</button>
            </div>
            <button class="close-modal" onclick="closeAddMember()">рдмрдВрдж рдХрд░реЗрдВ</button>
        </div>
    </div>

    <!-- RELATIONSHIP CALCULATOR MODAL -->
    <div class="modal" id="calculatorModal">
        <div class="modal-content">
            <div class="modal-title">рд╕рдВрдмрдВрдз рдХреИрд▓рдХреБрд▓реЗрдЯрд░</div>
            
            <div class="calc-form">
                <div class="calc-input-group">
                    <label>рдкрд╣рд▓рд╛ рд╡реНрдпрдХреНрддрд┐</label>
                    <div class="autocomplete">
                         <input type="text" id="calcInput1" placeholder="рдирд╛рдо рд▓рд┐рдЦреЗрдВ..." autocomplete="off">
                         <div id="calcList1" class="autocomplete-items"></div>
                    </div>
                </div>

                <div class="calc-input-group">
                    <label>рджреВрд╕рд░рд╛ рд╡реНрдпрдХреНрддрд┐</label>
                    <div class="autocomplete">
                        <input type="text" id="calcInput2" placeholder="рдирд╛рдо рд▓рд┐рдЦреЗрдВ..." autocomplete="off">
                        <div id="calcList2" class="autocomplete-items"></div>
                    </div>
                </div>

                <button class="btn calc-btn" onclick="calculateRelationship()">рд╕рдВрдмрдВрдз рджреЗрдЦреЗрдВ</button>

                <div id="calcResult" class="calc-result" style="display: none;">
                    <div class="relation-text" id="relationText"></div>
                    <div class="relation-path" id="relationPath"></div>
                </div>
            </div>

            <button class="close-modal" onclick="closeCalculator()">рдмрдВрдж рдХрд░реЗрдВ</button>
        </div>
    </div>

    <!-- MY LINEAGE MODAL -->
    <div class="modal" id="lineageModal">
        <div class="modal-content">
            <div class="modal-title"> рдореЗрд░рд╛ рд╡рдВрд╢ (My Lineage)</div>
            
            <div class="calc-form">
                <div class="calc-input-group">
                    <label>рдЕрдкрдирд╛ рдирд╛рдо рдЪреБрдиреЗрдВ</label>
                    <div class="autocomplete">
                        <input type="text" id="lineageInput" placeholder="рдЕрдкрдирд╛ рдирд╛рдо рд▓рд┐рдЦреЗрдВ..." autocomplete="off">
                        <div id="lineageList" class="autocomplete-items"></div>
                    </div>
                </div>

                <button class="btn calc-btn" onclick="showMyLineage()">рд╡рдВрд╢ рджреЗрдЦреЗрдВ</button>

                <div id="lineageResult" style="display: none;">
                    <div class="lineage-title" id="lineagePersonName"></div>
                    <div class="lineage-path" id="lineagePath"></div>
                </div>
            </div>

            <button class="close-modal" onclick="closeLineage()">рдмрдВрдж рдХрд░реЗрдВ</button>
        </div>
    </div>

    <!-- VILLAGE INFORMATION PAGE -->
    <div id="villagePage" class="page-section" style="display: none;">
        <div class="header">
            <button class="back-btn" onclick="closeVillagePage()">тЖР рд╡рд╛рдкрд╕</button>
            <h1 id="villageTitle">рд╣рдорд╛рд░рд╛ рдЧрд╛рдБрд╡: рдкрд╛рдВрдбреЗ рдЧрд╛рдБрд╡</h1>
        </div>

        <div class="village-content">
            <div class="village-hero" style="background-image: url('assets/village_hero.png')">
                <div class="village-hero-overlay">
                    <h2>рд╣рдорд╛рд░реА рдЬрдбрд╝реЛрдВ рдХрд╛ рдЧреМрд░рд╡</h2>
                    <p>рд╣рд┐рдорд╛рд▓рдп рдХреА рдЧреЛрдж рдореЗрдВ рдмрд╕рд╛ рдПрдХ рд╕реБрдВрджрд░ рд╕реНрдерд╛рди</p>
                </div>
            </div>

            <div class="section-card">
                <h3>ЁЯУЬ рдЗрддрд┐рд╣рд╛рд╕ (History)</h3>
                <p>рд╣рдорд╛рд░рд╛ рдЧрд╛рдБрд╡ "рдкрд╛рдВрдбреЗ рдЧрд╛рдБрд╡" рдкреАрдврд╝рд┐рдпреЛрдВ рд╕реЗ рдкрд╛рдВрдбреЗ рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдирд┐рд╡рд╛рд╕ рд╕реНрдерд╛рди рд░рд╣рд╛ рд╣реИред рдпрд╣рд╛рдБ рдХреА рдорд┐рдЯреНрдЯреА рдореЗрдВ рд╣рдорд╛рд░реЗ рдкреВрд░реНрд╡рдЬреЛрдВ рдХреА рдХрд╣рд╛рдирд┐рдпрд╛рдБ рдФрд░ рд╕рдВрд╕реНрдХреГрддрд┐ рд░рдЪреА-рдмрд╕реА рд╣реИред рдпрд╣ рдЧрд╛рдБрд╡ рдЕрдкрдиреА рдкреНрд░рд╛рдХреГрддрд┐рдХ рд╕реБрдВрджрд░рддрд╛ рдФрд░ рд╢рд╛рдВрдд рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред</p>
            </div>

            <div class="section-card">
                <h3>ЁЯПЫ рдкреНрд░рдореБрдЦ рд╕реНрдерд▓ (Landmarks)</h3>
                <div class="landmark-grid">
                    <div class="landmark-card">
                        <img src="assets/village_temple.png" alt="рдордВрджрд┐рд░">
                        <div class="landmark-info">
                            <h4>рдХреБрд▓рджреЗрд╡рддрд╛ рдордВрджрд┐рд░</h4>
                            <p>рд╣рдорд╛рд░рд╛ рдкреНрд░рд╛рдЪреАрди рдордВрджрд┐рд░ рдЬрд╣рд╛рдБ рдкреАрдврд╝рд┐рдпреЛрдВ рд╕реЗ рдкреВрдЬрд╛ рд╣реЛрддреА рдЖ рд░рд╣реА рд╣реИред</p>
                        </div>
                    </div>
                    <div class="landmark-card">
                        <img src="assets/village_school.png" alt="рд╕реНрдХреВрд▓">
                        <div class="landmark-info">
                            <h4>рдЧрд╛рдБрд╡ рдХрд╛ рд╕реНрдХреВрд▓</h4>
                            <p>рд╡рд╣ рд╕реНрдерд╛рди рдЬрд╣рд╛рдБ рд╣рдорд╛рд░реЗ рдкрд░рд┐рд╡рд╛рд░ рдХреЗ рдХрдИ рд╕рджрд╕реНрдпреЛрдВ рдиреЗ рд╢рд┐рдХреНрд╖рд╛ рдкреНрд░рд╛рдкреНрдд рдХреАред</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-card">
                <h3>ЁЯУН рд╕реНрдерд╛рди (Location)</h3>
                <div class="map-placeholder">
                    <p>рдЙрддреНрддрд░рд╛рдЦрдВрдб рдХреА рдЦреВрдмрд╕реВрд░рдд рдкрд╣рд╛рдбрд╝рд┐рдпреЛрдВ рдореЗрдВ рд╕реНрдерд┐рдд</p>
                    <button class="btn btn-secondary btn-narrow" onclick="window.open('https://www.google.com/maps', '_blank')">Google Maps рдкрд░ рджреЗрдЦреЗрдВ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="focusBanner" class="focus-banner"><b>рдлреЛрдХрд╕ рдореЛрдб:</b> рдЖрдкрдХреА рд╢рд╛рдЦрд╛ рджрд┐рдЦрд╛рдИ рдЬрд╛ рд░рд╣реА рд╣реИред рд╡рд╛рдкрд╕ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП "тЖР рд╡рд╛рдкрд╕" рджрдмрд╛рдПрдВред</div>

    <div class="scroll-hint" id="scrollHint">тЖР рд╕реНрд╡рд╛рдЗрдк рдХрд░рдХреЗ рджреЗрдЦреЗрдВ тЖТ</div>
    <script>
      // Register Service Worker for PWA
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js')
          .then(reg => console.log('Service Worker registered'))
          .catch(err => console.log('SW registration failed:', err));
      }
    </script>
   <div id="assistantFab" class="assistant-fab" onclick="toggleAssistant()" title="AI рд╡рдВрд╢ рдЧрд╛рдЗрдб">
       <span>тЬи</span>
   </div>

   <div id="assistantWindow" class="assistant-window">
       <div class="assistant-header">
           <div class="assistant-title">тЬи AI рд╡рдВрд╢ рдЧрд╛рдЗрдб</div>
           <button class="assistant-close" onclick="toggleAssistant()">├Ч</button>
       </div>
       <div id="assistantMessages" class="assistant-messages">
           <div class="message assistant">рдирдорд╕реНрддреЗ! рдореИрдВ рдЖрдкрдХрд╛ рдкрд╛рдВрдбреЗ рдкрд░рд┐рд╡рд╛рд░ рдЧрд╛рдЗрдб рд╣реВрдБред рдЖрдк рдореБрдЭрд╕реЗ рдЕрдкрдиреЗ рд╡рдВрд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВред</div>
           <div class="message assistant">рдЙрджрд╛рд╣рд░рдг: "рд╕рдмрд╕реЗ рдмреБрдЬреБрд░реНрдЧ рдХреМрди рд╣реИрдВ?", "рдЕрдЧрд▓реЗ 100 рд╕рд╛рд▓ рдореЗрдВ рдХрд┐рддрдиреЗ рд╕рджрд╕реНрдп рд╣реЛрдВрдЧреЗ?", "[Name] рдХреЗ рдХрд┐рддрдиреЗ рдмрдЪреНрдЪреЗ рд╣реИрдВ?"</div>
       </div>
       <div class="assistant-input-area">
           <button id="micBtn" class="mic-btn" title="рдЖрд╡рд╛реЫ рд╕реЗ рдкреВрдЫреЗрдВ (Voice Search)">ЁЯОд</button>
           <input type="text" id="assistantInput" placeholder="рдЕрдкрдирд╛ рдкреНрд░рд╢реНрди рдпрд╣рд╛рдБ рд▓рд┐рдЦреЗрдВ..." autocomplete="off">
           <button id="sendAssistantBtn" onclick="handleAssistantQuery()">тЖТ</button>
       </div>
   </div>

   <script src="data.js"></script>
   <script src="index.js"></script>
   <script src="assistant.js"></script>
</body>
</html>